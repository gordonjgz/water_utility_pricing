scale_color_manual(values = color_palette) +
scale_linetype_manual(
values = c("Status Quo - Flat" = "dotted",
"Status Quo" = "dotdash")
) +
coord_cartesian(ylim = c(0, 500)) +
academic_theme
q = seq(0.5, 50, by = 0.1)
gen_p = function(p, t, A, q) {
A1 = A[1]
A2 = A[2]
A3 = A[3]
A4 = A[4]
A5 = A[5]
t1 = t[1]
t2 = t[2]
t3 = t[3]
t4 = t[4]
p1 = p[1]
p2 = p[2]
p3 = p[3]
p4 = p[4]
p5 = p[5]
ap = case_when(
q <= t1 ~ (A1 + p1 * q) / q,
q > t1 & q <= t2 ~ (A2 + p1 * t1 + (p2 - 0.2) * (q - t1) + 0.2 * q) / q,
q > t2 & q <= t3 ~ (A3 + (p1 - 0.2) * t1 + (p2 - 0.2) * (t2 - t1) + (p3 - 0.2) * (q - t2) + 0.2 * q) / q,
q > t3 & q <= t4 ~ (A4 + (p1 - 0.2) * t1 + (p2 - 0.2) * (t2 - t1) + (p3 - 0.2) * (t3 - t2) + (p4 - 0.2) * (q - t3) + 0.2 * q) / q,
q > t4 ~ (A5 + (p1 - 0.2) * t1 + (p2 - 0.2) * (t2 - t1) + (p3 - 0.2) * (t3 - t2) + (p4 - 0.2) * (t4 - t3) + (p5 - 0.2) * (q - t4) + 0.2 * q) / q
)
mp = case_when(
q <= t1 ~ p1,
q > t1 & q <= t2 ~ p2,
q > t2 & q <= t3 ~ p3,
q > t3 & q <= t4 ~ p4,
q > t4 ~ p5
)
total = ap * q
result = data.frame(q, ap, mp, total)
colnames(result) = c("q", "ap", "mp", "total")
return(result)
}
t = read_csv(file = "results/PD_kinks.csv")
t = t$`0`
mp_i = read_csv(file = "results/PD_price_inelastic.csv")
mp_i = mp_i$`0`
mp_e = read_csv(file = "results/PD_price_base.csv")
mp_e = mp_e$`0`
fp_i = read_csv(file = "results/PD_fixed_payments_inelastic.csv")
fp_i = fp_i$`0`
fp_e = read_csv(file = "results/PD_fixed_payments_elastic.csv")
fp_e = fp_e$`0`
mp0 = c(3.09,5.01,8.54,12.9,14.41)
t0 = c(2,6,11,20)
fp_0 = c(8.5,10.8,16.5,37,37)
statusquo = gen_p(mp0, t0, fp_0, q)
statusquo$step = "status_quo"
inelastic = gen_p(mp_i, t, fp_i, q)
elastic = gen_p(mp_e, t, fp_e, q)
elastic$step = "Elastic PD"
inelastic$step = "Inelastic PD"
mp_flat = rep(mean(c(3.09,5.01,8.54,12.9,14.41)),5 )
fp_flat = rep(mean(c(8.5,10.8,16.5,37,37)),5 )
flat = gen_p(mp_flat, t0, fp_flat, q)
flat$step = "flat"
color_palette = c(
"Elastic PD" = "#0072B2",
"Inelastic PD" = "#D55E00"
)
pd_all = bind_rows(elastic, inelastic)
ggplot() +
geom_line(
data = pd_all,
aes(x = q, y = total, color = step),
linewidth = 1
) +
geom_line(
data = flat,
aes(x = q, y = total, linetype = "Status Quo - Flat"),
color = "#6e6e6e",
linewidth = 0.8
) +
geom_line(
data = statusquo,
aes(x = q, y = total, linetype = "Status Quo"),
color = "#080808",
linewidth = 0.8
) +
xlab("Quantity (k Gallons)") +
ylab("Total Payment ($)") +
labs(title = expression(zeta[1] <= 0)) +
scale_color_manual(values = color_palette) +
scale_linetype_manual(
values = c("Status Quo - Flat" = "dotted",
"Status Quo" = "dotdash")
) +
coord_cartesian(ylim = c(0, 1000)) +
academic_theme
##### price result ########
q = seq(0.5, 100, by = 0.1)
gen_p = function(p, t, A, q) {
A1 = A[1]
A2 = A[2]
A3 = A[3]
A4 = A[4]
A5 = A[5]
t1 = t[1]
t2 = t[2]
t3 = t[3]
t4 = t[4]
p1 = p[1]
p2 = p[2]
p3 = p[3]
p4 = p[4]
p5 = p[5]
ap = case_when(
q <= t1 ~ (A1 + p1 * q) / q,
q > t1 & q <= t2 ~ (A2 + p1 * t1 + (p2 - 0.2) * (q - t1) + 0.2 * q) / q,
q > t2 & q <= t3 ~ (A3 + (p1 - 0.2) * t1 + (p2 - 0.2) * (t2 - t1) + (p3 - 0.2) * (q - t2) + 0.2 * q) / q,
q > t3 & q <= t4 ~ (A4 + (p1 - 0.2) * t1 + (p2 - 0.2) * (t2 - t1) + (p3 - 0.2) * (t3 - t2) + (p4 - 0.2) * (q - t3) + 0.2 * q) / q,
q > t4 ~ (A5 + (p1 - 0.2) * t1 + (p2 - 0.2) * (t2 - t1) + (p3 - 0.2) * (t3 - t2) + (p4 - 0.2) * (t4 - t3) + (p5 - 0.2) * (q - t4) + 0.2 * q) / q
)
mp = case_when(
q <= t1 ~ p1,
q > t1 & q <= t2 ~ p2,
q > t2 & q <= t3 ~ p3,
q > t3 & q <= t4 ~ p4,
q > t4 ~ p5
)
total = ap * q
result = data.frame(q, ap, mp, total)
colnames(result) = c("q", "ap", "mp", "total")
return(result)
}
t = read_csv(file = "results/PD_kinks.csv")
t = t$`0`
mp_i = read_csv(file = "results/PD_price_inelastic.csv")
mp_i = mp_i$`0`
mp_e = read_csv(file = "results/PD_price_base.csv")
mp_e = mp_e$`0`
fp_i = read_csv(file = "results/PD_fixed_payments_inelastic.csv")
fp_i = fp_i$`0`
fp_e = read_csv(file = "results/PD_fixed_payments_elastic.csv")
fp_e = fp_e$`0`
mp0 = c(3.09,5.01,8.54,12.9,14.41)
t0 = c(2,6,11,20)
fp_0 = c(8.5,10.8,16.5,37,37)
statusquo = gen_p(mp0, t0, fp_0, q)
statusquo$step = "status_quo"
inelastic = gen_p(mp_i, t, fp_i, q)
elastic = gen_p(mp_e, t, fp_e, q)
elastic$step = "Elastic PD"
inelastic$step = "Inelastic PD"
mp_flat = rep(mean(c(3.09,5.01,8.54,12.9,14.41)),5 )
fp_flat = rep(mean(c(8.5,10.8,16.5,37,37)),5 )
flat = gen_p(mp_flat, t0, fp_flat, q)
flat$step = "flat"
color_palette = c(
"Elastic PD" = "#0072B2",
"Inelastic PD" = "#D55E00"
)
pd_all = bind_rows(elastic, inelastic)
ggplot() +
geom_line(
data = pd_all,
aes(x = q, y = total, color = step),
linewidth = 1
) +
geom_line(
data = flat,
aes(x = q, y = total, linetype = "Status Quo - Flat"),
color = "#6e6e6e",
linewidth = 0.8
) +
geom_line(
data = statusquo,
aes(x = q, y = total, linetype = "Status Quo"),
color = "#080808",
linewidth = 0.8
) +
xlab("Quantity (k Gallons)") +
ylab("Total Payment ($)") +
labs(title = expression(zeta[1] <= 0)) +
scale_color_manual(values = color_palette) +
scale_linetype_manual(
values = c("Status Quo - Flat" = "dotted",
"Status Quo" = "dotdash")
) +
coord_cartesian(ylim = c(0, 1000)) +
academic_theme
ggplot() +
geom_line(
data = pd_all,
aes(x = q, y = total, color = step),
linewidth = 1
) +
geom_line(
data = flat,
aes(x = q, y = total, linetype = "Status Quo - Flat"),
color = "#6e6e6e",
linewidth = 0.8
) +
geom_line(
data = statusquo,
aes(x = q, y = total, linetype = "Status Quo"),
color = "#080808",
linewidth = 0.8
) +
xlab("Quantity (k Gallons)") +
ylab("Total Payment ($)") +
labs(title = expression(zeta[1] <= 0)) +
scale_color_manual(values = color_palette) +
scale_linetype_manual(
values = c("Status Quo - Flat" = "dotted",
"Status Quo" = "dotdash")
) +
coord_cartesian(ylim = c(0, 2000)) +
academic_theme
q = seq(0.5, 75, by = 0.1)
gen_p = function(p, t, A, q) {
A1 = A[1]
A2 = A[2]
A3 = A[3]
A4 = A[4]
A5 = A[5]
t1 = t[1]
t2 = t[2]
t3 = t[3]
t4 = t[4]
p1 = p[1]
p2 = p[2]
p3 = p[3]
p4 = p[4]
p5 = p[5]
ap = case_when(
q <= t1 ~ (A1 + p1 * q) / q,
q > t1 & q <= t2 ~ (A2 + p1 * t1 + (p2 - 0.2) * (q - t1) + 0.2 * q) / q,
q > t2 & q <= t3 ~ (A3 + (p1 - 0.2) * t1 + (p2 - 0.2) * (t2 - t1) + (p3 - 0.2) * (q - t2) + 0.2 * q) / q,
q > t3 & q <= t4 ~ (A4 + (p1 - 0.2) * t1 + (p2 - 0.2) * (t2 - t1) + (p3 - 0.2) * (t3 - t2) + (p4 - 0.2) * (q - t3) + 0.2 * q) / q,
q > t4 ~ (A5 + (p1 - 0.2) * t1 + (p2 - 0.2) * (t2 - t1) + (p3 - 0.2) * (t3 - t2) + (p4 - 0.2) * (t4 - t3) + (p5 - 0.2) * (q - t4) + 0.2 * q) / q
)
mp = case_when(
q <= t1 ~ p1,
q > t1 & q <= t2 ~ p2,
q > t2 & q <= t3 ~ p3,
q > t3 & q <= t4 ~ p4,
q > t4 ~ p5
)
total = ap * q
result = data.frame(q, ap, mp, total)
colnames(result) = c("q", "ap", "mp", "total")
return(result)
}
t = read_csv(file = "results/PD_kinks.csv")
t = t$`0`
mp_i = read_csv(file = "results/PD_price_inelastic.csv")
mp_i = mp_i$`0`
mp_e = read_csv(file = "results/PD_price_base.csv")
mp_e = mp_e$`0`
fp_i = read_csv(file = "results/PD_fixed_payments_inelastic.csv")
fp_i = fp_i$`0`
fp_e = read_csv(file = "results/PD_fixed_payments_elastic.csv")
fp_e = fp_e$`0`
mp0 = c(3.09,5.01,8.54,12.9,14.41)
t0 = c(2,6,11,20)
fp_0 = c(8.5,10.8,16.5,37,37)
statusquo = gen_p(mp0, t0, fp_0, q)
statusquo$step = "status_quo"
inelastic = gen_p(mp_i, t, fp_i, q)
elastic = gen_p(mp_e, t, fp_e, q)
elastic$step = "Elastic PD"
inelastic$step = "Inelastic PD"
mp_flat = rep(mean(c(3.09,5.01,8.54,12.9,14.41)),5 )
fp_flat = rep(mean(c(8.5,10.8,16.5,37,37)),5 )
flat = gen_p(mp_flat, t0, fp_flat, q)
flat$step = "flat"
color_palette = c(
"Elastic PD" = "#0072B2",
"Inelastic PD" = "#D55E00"
)
pd_all = bind_rows(elastic, inelastic)
ggplot() +
geom_line(
data = pd_all,
aes(x = q, y = total, color = step),
linewidth = 1
) +
geom_line(
data = flat,
aes(x = q, y = total, linetype = "Status Quo - Flat"),
color = "#6e6e6e",
linewidth = 0.8
) +
geom_line(
data = statusquo,
aes(x = q, y = total, linetype = "Status Quo"),
color = "#080808",
linewidth = 0.8
) +
xlab("Quantity (k Gallons)") +
ylab("Total Payment ($)") +
scale_color_manual(values = color_palette) +
scale_linetype_manual(
values = c("Status Quo - Flat" = "dotted",
"Status Quo" = "dotdash")
) +
coord_cartesian(ylim = c(0, 2500)) +
academic_theme
ggplot() +
geom_line(
data = pd_all,
aes(x = q, y = total, color = step),
linewidth = 1.2
) +
geom_line(
data = flat,
aes(x = q, y = total, linetype = "Status Quo - Flat"),
color = "#6e6e6e",
linewidth = 0.8
) +
geom_line(
data = statusquo,
aes(x = q, y = total, linetype = "Status Quo"),
color = "#080808",
linewidth = 0.8
) +
xlab("Quantity (k Gallons)") +
ylab("Total Payment ($)") +
scale_color_manual(values = color_palette) +
scale_linetype_manual(
values = c("Status Quo - Flat" = "dotted",
"Status Quo" = "dotdash")
) +
labs(color = NULL, linetype = NULL) +  # ← removes legend titles
theme(legend.title = element_blank()) + # ← extra safety
coord_cartesian(ylim = c(0, 2500)) +
academic_theme
ggplot() +
geom_step(
data = elastic,
aes(x = q, y = mp, color = step),
linewidth = 1
) +
geom_step(
data = inelastic,
aes(x = q, y = mp, color = step),
linewidth = 1
) +
geom_step(
data = statusquo,
aes(x = q, y = mp, linetype = "Status Quo"),
color = "#080808",
linewidth = 0.8
) +
xlab("Quantity (k Gallons)") +
ylab("Marginal Price ($)") +
scale_color_manual(values = color_palette) +
scale_linetype_manual(
values = c("Status Quo" = "dotdash")
) +
labs(color = NULL, linetype = NULL) +
theme(legend.title = element_blank()) +
academic_theme
##### price result ########
q = seq(0.5, 100, by = 0.1)
gen_p = function(p, t, A, q) {
A1 = A[1]
A2 = A[2]
A3 = A[3]
A4 = A[4]
A5 = A[5]
t1 = t[1]
t2 = t[2]
t3 = t[3]
t4 = t[4]
p1 = p[1]
p2 = p[2]
p3 = p[3]
p4 = p[4]
p5 = p[5]
ap = case_when(
q <= t1 ~ (A1 + p1 * q) / q,
q > t1 & q <= t2 ~ (A2 + p1 * t1 + (p2 - 0.2) * (q - t1) + 0.2 * q) / q,
q > t2 & q <= t3 ~ (A3 + (p1 - 0.2) * t1 + (p2 - 0.2) * (t2 - t1) + (p3 - 0.2) * (q - t2) + 0.2 * q) / q,
q > t3 & q <= t4 ~ (A4 + (p1 - 0.2) * t1 + (p2 - 0.2) * (t2 - t1) + (p3 - 0.2) * (t3 - t2) + (p4 - 0.2) * (q - t3) + 0.2 * q) / q,
q > t4 ~ (A5 + (p1 - 0.2) * t1 + (p2 - 0.2) * (t2 - t1) + (p3 - 0.2) * (t3 - t2) + (p4 - 0.2) * (t4 - t3) + (p5 - 0.2) * (q - t4) + 0.2 * q) / q
)
mp = case_when(
q <= t1 ~ p1,
q > t1 & q <= t2 ~ p2,
q > t2 & q <= t3 ~ p3,
q > t3 & q <= t4 ~ p4,
q > t4 ~ p5
)
total = ap * q
result = data.frame(q, ap, mp, total)
colnames(result) = c("q", "ap", "mp", "total")
return(result)
}
t = read_csv(file = "results/PD_kinks.csv")
t = t$`0`
mp_i = read_csv(file = "results/PD_price_inelastic.csv")
mp_i = mp_i$`0`
mp_e = read_csv(file = "results/PD_price_base.csv")
mp_e = mp_e$`0`
fp_i = read_csv(file = "results/PD_fixed_payments_inelastic.csv")
fp_i = fp_i$`0`
fp_e = read_csv(file = "results/PD_fixed_payments_elastic.csv")
fp_e = fp_e$`0`
mp0 = c(3.09,5.01,8.54,12.9,14.41)
t0 = c(2,6,11,20)
fp_0 = c(8.5,10.8,16.5,37,37)
statusquo = gen_p(mp0, t0, fp_0, q)
statusquo$step = "status_quo"
inelastic = gen_p(mp_i, t, fp_i, q)
elastic = gen_p(mp_e, t, fp_e, q)
elastic$step = "Elastic PD"
inelastic$step = "Inelastic PD"
mp_flat = rep(mean(c(3.09,5.01,8.54,12.9,14.41)),5 )
fp_flat = rep(mean(c(8.5,10.8,16.5,37,37)),5 )
flat = gen_p(mp_flat, t0, fp_flat, q)
flat$step = "flat"
color_palette = c(
"Elastic PD" = "#0072B2",
"Inelastic PD" = "#D55E00"
)
pd_all = bind_rows(elastic, inelastic)
ggplot() +
geom_line(
data = pd_all,
aes(x = q, y = total, color = step),
linewidth = 1.2
) +
geom_line(
data = flat,
aes(x = q, y = total, linetype = "Status Quo - Flat"),
color = "#6e6e6e",
linewidth = 0.8
) +
geom_line(
data = statusquo,
aes(x = q, y = total, linetype = "Status Quo"),
color = "#080808",
linewidth = 0.8
) +
xlab("Quantity (k Gallons)") +
ylab("Total Payment ($)") +
scale_color_manual(values = color_palette) +
scale_linetype_manual(
values = c("Status Quo - Flat" = "dotted",
"Status Quo" = "dotdash")
) +
labs(color = NULL, linetype = NULL) +  # ← removes legend titles
theme(legend.title = element_blank()) + # ← extra safety
coord_cartesian(xlim = c(0, 75), ylim = c(0, 2500)) +
academic_theme
ggplot() +
geom_step(
data = elastic,
aes(x = q, y = mp, color = step),
linewidth = 1
) +
geom_step(
data = inelastic,
aes(x = q, y = mp, color = step),
linewidth = 1
) +
geom_step(
data = statusquo,
aes(x = q, y = mp, linetype = "Status Quo"),
color = "#080808",
linewidth = 0.8
) +
xlab("Quantity (k Gallons)") +
ylab("Marginal Price ($)") +
scale_color_manual(values = color_palette) +
scale_linetype_manual(
values = c("Status Quo" = "dotdash")
) +
labs(color = NULL, linetype = NULL) +
theme(legend.title = element_blank()) +
academic_theme
ggplot() +
geom_line(
data = pd_all,
aes(x = q, y = total, color = step),
linewidth = 1.2
) +
geom_line(
data = flat,
aes(x = q, y = total, linetype = "Status Quo - Flat"),
color = "#6e6e6e",
linewidth = 0.8
) +
geom_line(
data = statusquo,
aes(x = q, y = total, linetype = "Status Quo"),
color = "#080808",
linewidth = 0.8
) +
xlab("Quantity (k Gallons)") +
ylab("Total Payment ($)") +
scale_color_manual(values = color_palette) +
scale_linetype_manual(
values = c("Status Quo - Flat" = "dotted",
"Status Quo" = "dotdash")
) +
labs(color = NULL, linetype = NULL) +  # ← removes legend titles
theme(legend.title = element_blank()) + # ← extra safety
#coord_cartesian(xlim = c(0, 75), ylim = c(0, 2500)) +
academic_theme
gc()
